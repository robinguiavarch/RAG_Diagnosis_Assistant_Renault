
============================================================
 ğŸ¯ TEST DU SYSTÃˆME DE RE-RANKING CROSSENCODER ğŸ¯
============================================================

------------------------------------------------------------
 TEST: DISPONIBILITÃ‰
------------------------------------------------------------

============================================================
 TEST DE DISPONIBILITÃ‰
============================================================
âœ… Module CrossEncoderReranker disponible
âœ… DisponibilitÃ©: RÃ‰USSI

------------------------------------------------------------
 TEST: INITIALISATION
------------------------------------------------------------

============================================================
 TEST D'INITIALISATION
============================================================
ğŸ”„ Test initialisation modÃ¨le par dÃ©faut...
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
âœ… Initialisation rÃ©ussie (2.50s)
ğŸ“Š Infos modÃ¨le:
   model_name: cross-encoder/ms-marco-MiniLM-L-6-v2
   device: cpu
   max_length: 512
   model_type: CrossEncoder
   framework: sentence-transformers
âœ… Initialisation: RÃ‰USSI

------------------------------------------------------------
 TEST: MODÃˆLE CUSTOM
------------------------------------------------------------

============================================================
 TEST MODÃˆLE CUSTOM
============================================================
ğŸ”„ Test avec modÃ¨le lÃ©ger...
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
âœ… ModÃ¨le cross-encoder/ms-marco-MiniLM-L-6-v2 chargÃ© (1.13s)
âœ… ModÃ¨le custom: RÃ‰USSI

------------------------------------------------------------
 TEST: RE-RANKING BASIQUE
------------------------------------------------------------

============================================================
 TEST RE-RANKING BASIQUE
============================================================
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
âœ… Reranker initialisÃ©
ğŸ” RequÃªte: "ACAL-006 error on FANUC robot teach pendant"
ğŸ“Š Candidats: 5

ğŸ“‹ AVANT RE-RANKING (tri par score fusion):
   1. Score: 0.850 | fanuc_manual|error_001
      ACAL-006 TPE operation error occurs when the teach pendant encounters a communic...
   2. Score: 0.750 | fanuc_manual|error_002
      Robot calibration procedures must be followed exactly. Improper calibration can ...
   3. Score: 0.700 | technical_guide|troubleshoot_001
      When troubleshooting FANUC robots, first check the error code display on the tea...
   4. Score: 0.450 | safety_manual|safety_001
      Safety procedures require proper shutdown before maintenance. Always disconnect ...
   5. Score: 0.350 | installation_guide|install_001
      Installation of robotic systems requires careful planning and adherence to manuf...

ğŸ¯ Re-ranking avec CrossEncoder...
ğŸ¯ Re-ranking de 5 candidats avec CrossEncoder
ğŸ“Š Scoring 5 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: 7.4238
ğŸ¥ˆ Top-2 score: 4.7356
âœ… Re-ranking terminÃ© (0.14s)

ğŸ† APRÃˆS RE-RANKING (tri par CrossEncoder):
   1. CrossEncoder: 7.424 | Fusion: 0.850 | Rang orig: #1
      fanuc_manual|error_001
      ACAL-006 TPE operation error occurs when the teach pendant encounters a communic...
   2. CrossEncoder: 4.736 | Fusion: 0.700 | Rang orig: #3
      technical_guide|troubleshoot_001
      When troubleshooting FANUC robots, first check the error code display on the tea...
   3. CrossEncoder: -9.411 | Fusion: 0.750 | Rang orig: #2
      fanuc_manual|error_002
      Robot calibration procedures must be followed exactly. Improper calibration can ...
   4. CrossEncoder: -11.145 | Fusion: 0.350 | Rang orig: #5
      installation_guide|install_001
      Installation of robotic systems requires careful planning and adherence to manuf...
   5. CrossEncoder: -11.398 | Fusion: 0.450 | Rang orig: #4
      safety_manual|safety_001
      Safety procedures require proper shutdown before maintenance. Always disconnect ...

ğŸ“Š ANALYSE DES CHANGEMENTS:
   ğŸ”„ Positions changÃ©es: 4/5
   â±ï¸ Temps par document: 27.9ms
   âœ… Le meilleur rÃ©sultat contient les termes clÃ©s de la requÃªte
âœ… Re-ranking basique: RÃ‰USSI

------------------------------------------------------------
 TEST: CAS LIMITES
------------------------------------------------------------

============================================================
 TEST CAS LIMITES
============================================================
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
ğŸ“Š Test 1: Liste de candidats vide
âš ï¸ Aucun candidat Ã  re-ranker
   RÃ©sultat: 0 documents (attendu: 0)

ğŸ“Š Test 2: RequÃªte vide
âš ï¸ RequÃªte vide pour re-ranking, retour rÃ©sultats originaux
   RÃ©sultat: 2 documents
   Ordre conservÃ©: True

ğŸ“Š Test 3: Candidats avec textes vides
ğŸ¯ Re-ranking de 3 candidats avec CrossEncoder
âš ï¸ Candidat 1 ignorÃ© (texte vide)
âš ï¸ Candidat 3 ignorÃ© (texte vide)
ğŸ“Š Scoring 1 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: -10.9076
   Candidats originaux: 3
   Candidats re-rankÃ©s: 1

ğŸ“Š Test 4: top_k > nombre de candidats
ğŸ¯ Re-ranking de 2 candidats avec CrossEncoder
ğŸ“Š Scoring 2 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: -8.7291
ğŸ¥ˆ Top-2 score: -10.1280
   Candidats: 2, top_k: 10, rÃ©sultat: 2

ğŸ“Š Test 5: Texte trÃ¨s long
ğŸ¯ Re-ranking de 1 candidats avec CrossEncoder
ğŸ“Š Scoring 1 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: -11.0642
   Texte original: 2600 chars
   Traitement rÃ©ussi: True
âœ… Cas limites: RÃ‰USSI

------------------------------------------------------------
 TEST: SCORE PAIRS
------------------------------------------------------------

============================================================
 TEST SCORE PAIRS
============================================================
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
ğŸ” Test de 4 paires query-document
âœ… Scoring terminÃ© (0.03s)

ğŸ“Š RÃ‰SULTATS DES SCORES:
   1. Score: 6.3944
      Query: "robot error"
      Doc: "The robot displays an error message on screen..."

   2. Score: -11.2621
      Query: "robot error"
      Doc: "Installing new software on the computer..."

   3. Score: 2.3222
      Query: "calibration procedure"
      Doc: "Follow calibration steps carefully for accuracy..."

   4. Score: -11.2759
      Query: "calibration procedure"
      Doc: "The weather is nice today..."

ğŸ“ˆ Score moyen pertinent: 4.3583
ğŸ“‰ Score moyen non-pertinent: -11.2690
âœ… Logique des scores correcte (pertinent > non-pertinent)
âœ… Score pairs: RÃ‰USSI

------------------------------------------------------------
 TEST: PERFORMANCE
------------------------------------------------------------

============================================================
 TEST PERFORMANCE
============================================================
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
ğŸš€ Benchmark avec requÃªte: "FANUC robot error ACAL-006"

ğŸ“Š Test avec 5 candidats:
ğŸ¯ Re-ranking de 5 candidats avec CrossEncoder
ğŸ“Š Scoring 5 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: 3.9098
ğŸ¥ˆ Top-2 score: 2.2814
   â±ï¸ Temps total: 0.042s
   ğŸ“ˆ Documents/seconde: 119.5
   ğŸ“Š ms par document: 8.4ms
   âœ… RÃ©sultats: 5

ğŸ“Š Test avec 10 candidats:
ğŸ¯ Re-ranking de 10 candidats avec CrossEncoder
ğŸ“Š Scoring 10 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: 3.9342
ğŸ¥ˆ Top-2 score: 3.9098
   â±ï¸ Temps total: 0.033s
   ğŸ“ˆ Documents/seconde: 301.4
   ğŸ“Š ms par document: 3.3ms
   âœ… RÃ©sultats: 5

ğŸ“Š Test avec 20 candidats:
ğŸ¯ Re-ranking de 20 candidats avec CrossEncoder
ğŸ“Š Scoring 20 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: 3.9896
ğŸ¥ˆ Top-2 score: 3.9739
   â±ï¸ Temps total: 0.056s
   ğŸ“ˆ Documents/seconde: 358.4
   ğŸ“Š ms par document: 2.8ms
   âœ… RÃ©sultats: 5

ğŸ§ª Test benchmark intÃ©grÃ©:
ğŸš€ Benchmark CrossEncoder: 5 documents, 3 runs
   Run 1: 0.014s
   Run 2: 0.014s
   Run 3: 0.016s
ğŸ“Š RÃ©sultats benchmark:
   avg_time_seconds: 0.014
   min_time_seconds: 0.014
   max_time_seconds: 0.016
   std_time_seconds: 0.001
   documents_per_second: 344.932
   device: cpu
   num_documents: 5
   num_runs: 3
âœ… Performance: RÃ‰USSI

------------------------------------------------------------
 TEST: DONNÃ‰ES FUSION
------------------------------------------------------------

============================================================
 TEST AVEC DONNÃ‰ES FUSION RÃ‰ALISTES
============================================================
ğŸ”„ Chargement CrossEncoder: cross-encoder/ms-marco-MiniLM-L-6-v2
ğŸ¯ Device cible: cpu
âœ… CrossEncoder chargÃ© avec succÃ¨s sur cpu
ğŸ” RequÃªte rÃ©aliste: "I got ACAL-006 error on my FANUC teach pendant, what should I do?"
ğŸ“Š 5 candidats de fusion

ğŸ“‹ ORDRE INITIAL (par score fusion):
   1. Fusion: 0.8245 | BM25: 0.9100 | FAISS: 0.7390
      fanuc_troubleshooting_guide
      ACAL-006 Teach Pendant Error: This error indicates a communication failure between the teach pendant...

   2. Fusion: 0.7891 | BM25: 0.8200 | FAISS: 0.7582
      fanuc_error_codes_manual
      ACAL series errors are related to calibration and positioning systems. ACAL-006 specifically refers ...

   3. Fusion: 0.7234 | BM25: 0.6890 | FAISS: 0.7578
      maintenance_procedures
      When troubleshooting communication errors between robot components, always start with physical conne...

   4. Fusion: 0.5467 | BM25: 0.5100 | FAISS: 0.5834
      safety_procedures
      When any error occurs on the robot system, immediately stop all operations and assess the situation....

   5. Fusion: 0.4123 | BM25: 0.3890 | FAISS: 0.4356
      installation_guide
      During initial robot installation, ensure all communication cables are properly routed and secured. ...

ğŸ¯ Re-ranking avec CrossEncoder...
ğŸ¯ Re-ranking de 5 candidats avec CrossEncoder
ğŸ“Š Scoring 5 paires query-document...
âœ… Re-ranking terminÃ©
ğŸ† Top-1 score: 7.0242
ğŸ¥ˆ Top-2 score: 5.3975
âœ… Re-ranking terminÃ© (0.047s)

ğŸ† ORDRE APRÃˆS RE-RANKING:
   1. CrossEncoder: 7.0242 | Fusion: 0.8245 | Rang orig: #1
      fanuc_troubleshooting_guide
      ACAL-006 Teach Pendant Error: This error indicates a communication failure between the teach pendant...
      âœ… Excellent match (contient ACAL-006 + teach pendant)

   2. CrossEncoder: 5.3975 | Fusion: 0.7891 | Rang orig: #2
      fanuc_error_codes_manual
      ACAL series errors are related to calibration and positioning systems. ACAL-006 specifically refers ...
      âœ… Excellent match (contient ACAL-006 + teach pendant)

   3. CrossEncoder: -10.1775 | Fusion: 0.5467 | Rang orig: #4
      safety_procedures
      When any error occurs on the robot system, immediately stop all operations and assess the situation....
      âŒ Match faible

   4. CrossEncoder: -10.9621 | Fusion: 0.7234 | Rang orig: #3
      maintenance_procedures
      When troubleshooting communication errors between robot components, always start with physical conne...
      âš ï¸ Match partiel

   5. CrossEncoder: -11.4476 | Fusion: 0.4123 | Rang orig: #5
      installation_guide
      During initial robot installation, ensure all communication cables are properly routed and secured. ...
      âš ï¸ Match partiel

ğŸ“Š ANALYSE DE L'AMÃ‰LIORATION:
   ğŸ”„ safety_procedures: position 4 â†’ 3
   ğŸ”„ maintenance_procedures: position 3 â†’ 4
   ğŸ“ˆ Changements de position: 2/5
   âœ… Le rÃ©sultat #1 contient ACAL-006 (trÃ¨s pertinent)
âœ… DonnÃ©es fusion: RÃ‰USSI

============================================================
 ğŸ“Š RAPPORT FINAL
============================================================
â±ï¸ Temps total: 9.9s
âœ… Tests rÃ©ussis: 8/8
ğŸ“ˆ Taux de rÃ©ussite: 100.0%

ğŸ‰ CROSSENCODER FONCTIONNE CORRECTEMENT!
ğŸ… Le systÃ¨me de re-ranking est opÃ©rationnel
ğŸ’¯ TOUS LES TESTS RÃ‰USSIS!

============================================================
 âœ… TEST CROSSENCODER TERMINÃ‰
============================================================
